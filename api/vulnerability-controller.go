package api

import (
	"net/http"
	"snowden/client"
)

func ReadVulnerabilityByCve(w http.ResponseWriter, r *http.Request) error {
	cveId := r.URL.Query().Get("id")

	vulnerability, err := client.GetVulnerabilityByCveId(cveId)
	if err != nil {
		return WriteJson(w, http.StatusBadRequest, Error{Error: err.Error()})
	}

	return WriteJson(w, http.StatusOK, vulnerability)
}

func ReadVulnerabilityByCwe(w http.ResponseWriter, r *http.Request) error {
	cweId := r.URL.Query().Get("id")

	vulnerability, err := client.GetVulnerabilityByCweId(cweId)
	if err != nil {
		return WriteJson(w, http.StatusBadRequest, Error{Error: err.Error()})
	}

	return WriteJson(w, http.StatusOK, vulnerability)
}
