package model

type Vulnerability struct {
	Cve Cve `json:"cve"`
}

type Cve struct {
	ID               string        `json:"id"`
	SourceIdentifier string        `json:"sourceIdentifier"`
	Published        string        `json:"published"`
	LastModified     string        `json:"lastModified"`
	VulnStatus       string        `json:"vulnStatus"`
	CveTags          []interface{} `json:"cveTags"`
	Descriptions     Descriptions  `json:"descriptions"`
	Metrics          struct {
		CvssMetricV31 CvssMetricV3 `json:"cvssMetricV31"`
		CvssMetricV30 CvssMetricV3 `json:"cvssMetricV30"`
		CvssMetricV2  CvssMetricV2 `json:"cvssMetricV2"`
	} `json:"metrics"`
	Weaknesses     Weaknesses     `json:"weaknesses"`
	Configurations Configurations `json:"configurations"`
	References     References     `json:"references"`
}

type Descriptions []struct {
	Lang  string `json:"lang"`
	Value string `json:"value"`
}

type CvssMetricV3 []struct {
	Source              string   `json:"source"`
	Type                string   `json:"type"`
	CvssData            CvssData `json:"cvssData"`
	ExploitabilityScore float64  `json:"exploitabilityScore"`
	ImpactScore         float64  `json:"impactScore"`
}

type CvssMetricV2 []struct {
	Source                  string   `json:"source"`
	Type                    string   `json:"type"`
	CvssData                CvssData `json:"cvssData"`
	BaseSeverity            string   `json:"baseSeverity"`
	ExploitabilityScore     float64  `json:"exploitabilityScore"`
	ImpactScore             float64  `json:"impactScore"`
	AcInsufInfo             bool     `json:"acInsufInfo"`
	ObtainAllPrivilege      bool     `json:"obtainAllPrivilege"`
	ObtainUserPrivilege     bool     `json:"obtainUserPrivilege"`
	ObtainOtherPrivilege    bool     `json:"obtainOtherPrivilege"`
	UserInteractionRequired bool     `json:"userInteractionRequired"`
}

type CvssData struct {
	Version               string  `json:"version"`
	VectorString          string  `json:"vectorString"`
	AttackVector          string  `json:"attackVector"`
	AttackComplexity      string  `json:"attackComplexity"`
	PrivilegesRequired    string  `json:"privilegesRequired"`
	UserInteraction       string  `json:"userInteraction"`
	Scope                 string  `json:"scope"`
	ConfidentialityImpact string  `json:"confidentialityImpact"`
	IntegrityImpact       string  `json:"integrityImpact"`
	AvailabilityImpact    string  `json:"availabilityImpact"`
	BaseScore             float64 `json:"baseScore"`
	BaseSeverity          string  `json:"baseSeverity"`
}

type Weaknesses []struct {
	Source      string       `json:"source"`
	Type        string       `json:"type"`
	Description Descriptions `json:"description"`
}

type Configurations []struct {
	Nodes Nodes `json:"nodes"`
}

type Nodes []struct {
	Operator string   `json:"operator"`
	Negate   bool     `json:"negate"`
	CpeMatch CpeMatch `json:"cpeMatch"`
}

type CpeMatch []struct {
	Vulnerable          bool   `json:"vulnerable"`
	Criteria            string `json:"criteria"`
	VersionEndExcluding string `json:"versionEndExcluding"`
	MatchCriteriaID     string `json:"matchCriteriaId"`
}

type References []struct {
	URL    string   `json:"url"`
	Source string   `json:"source"`
	Tags   []string `json:"tags"`
}
